\documentclass[
    paper=a4, % Seitenformat
    fontsize=10pt,  % Schriftgröße
]{article}         % KOMA-Script Article
%------------------------------------------------------------------------

\usepackage[automark]{scrlayer-scrpage}  % Seiten-Stil für scrartcl
\usepackage[utf8]{inputenc}              % Eingabekodierung
\usepackage[T1]{fontenc}                 % Zeichenkodierung
\usepackage[english,ngerman]{babel}      % Mehrsprachenumgebung, Hauptsprache Deutsch
\usepackage{setspace}
\usepackage{latexsym}                    % Latex-Symbole
\usepackage{amsfonts, amssymb, amstext}  % Mathematische Formeln
\usepackage{bbm}                         % bbm Schriftart
\usepackage{graphicx}                    % Abbildungen einbinden
\usepackage{tikz}                        % Abbildungen zeichnen
\usepackage{enumitem}
\usepackage[outputdir=out]{minted}
\usepackage{mathtools}
\usepackage{pdfpages}
\usepackage{algorithm2e}
\usepackage{fontawesome}
\usepackage{hyperref}
\usepackage[backend=biber,style=numeric,url=true,sorting=none,doi=false,urldate=long,natbib=true]{biblatex}
\usepackage[a4paper,lmargin={3cm},rmargin={3cm},tmargin={2.5cm},bmargin = {2.5cm}]{geometry}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{amsmath}
\usepackage{tabularx}
\usepackage{breqn}
\usepackage{empheq}

\pagestyle{scrheadings}                  % Kopfzeilen nach scr-Standard

\usetikzlibrary{automata}                % Tikz-Library zum Zeichnen von Automaten

\usepackage{csquotes}
\MakeOuterQuote{"}

% Horizontale Linie mit Abstand zu den Seitenrändern
\newcommand{\ownline}{\vspace{.7em}\hrule\vspace{.7em}}
\renewcommand{\ALG@name}{Algorithmus}
\newcommand{\RNum}[1]{\uppercase\expandafter{\romannumeral #1\relax}}
\newcommand{\qedwhite}{\hfill \ensuremath{\Box}}

\newtheorem{theorem}{Satz}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Beispiel}
\newtheorem{bem}[theorem]{Bemerkung}
\newtheorem{satz}[theorem]{Satz}
\newtheorem{lemma}[theorem]{Lemma}

\addbibresource{Bachelorarbeit.bib}
% Biblatex Konfiguration
\DeclareFieldFormat{urldate}{\mkbibbrackets{#1}}
\DeclareNameAlias{sortname}{last-first}
%\DeclareFieldFormat{date}{(#1)}
\renewcommand*{\labelnamepunct}{\addcolon\addspace}

%-----------------------------------------------------------------------------------
%%% DOCUMENT-HEAD %%%
%-----------------------------------------------------------------------------------

% This info will be visible in the document head
\author{Alexandro Jedaidi}
\title{\textbf{Vergleich der Integrationsmethoden und der Methoden des maschinellen Lernens für gewöhnliche Differentialgleichungen}}
\date{}

\begin{document}
    \maketitle
    \tableofcontents
    \newpage
    \begin{abstract}
        Bachelorabeit WiSe 2021/2022
    \end{abstract}
    \pagestyle{headings}

    \section{Einleitung}
    Citing template\cite{Google}

    \section{Problemstellung}
    In diesem Abschnitt wird die Theorie zu den gewöhnlichen Differentialgleichungen erläutert. Diese ist Grundlage für
    das Verständnis der Schlussfolgerungen und Ergebnisse dieser Arbeit.

    \subsection{Gewöhnliche Differentialgleichungen und Anfangswertprobleme}
    \begin{definition}
        Ein System gewöhnlicher Differentialgleichungen $m-ter$ Ordnung hat die Form
        \[
            x^{(m)} = f(t, x, x^{\prime}, x^{\prime\prime}, ..., x^{(m-1)}) \label{eq:1} \tag{\RNum{1}}
        \]
        mit der gegebenen Funktion
        $
        f : D \times \mathbb{R}^{n} \times \mathbb{R}^{n} \times ... \times \mathbb{R}^{n} \rightarrow \mathbb{R}^{n},
        $
        wobei $D \subseteq \mathbb{R}$ ein Zeitintervall ist. Eine dazugehörige Lösung (falls existent)
        $\hat{x} : D \rightarrow \mathbb{R}$ ist eine $m-mal$ differenzierbare Funktion und erfüllt die Bedingung
        \[
            \hat{x}^{(m)} = f(t, \hat{x},\hat{x}^{\prime},\hat{x}^{\prime\prime}, ...,\hat{x}^{(m-1)}).
        \]
    \end{definition}
    \begin{definition}
        Ein Anfangswertproblem für eine Differentialgleichung \eqref{eq:1} mit gegebenen Anfangswerten $x_{0,1},
        ...,x_{0,m} \in \mathbb{R}^{n}$ hat die Form
        \[
            x^{(m)} = f(t, x, x^{\prime}, x^{\prime\prime}, ..., x^{(m-1)}),\quad x(t_{0})=x_{0,1},\quad x^{\prime}(t_{0})=x_{0,2} \quad
            ,...,\quad x^{(m-1)}(t_{0})=x_{0,m}. \label{eq:2} \tag{\RNum{2}}
        \]
        Eine Lösung des Problems $\hat{x} : D \rightarrow \mathbb{R}$ muss also zusätzlich zu \eqref{eq:1} auch die
        Anfangswertbedingungen (vgl. \eqref{eq:2}) erfüllen.
    \end{definition}
    Es ist möglich jede gewöhnliche Differentialgleichung $m-ter$ Ordnung zu einem System gewöhnlicher Differential
    gleichungen $erster$ Ordnung umzuwandeln. Dies erleichtert uns in späteren Abschnitten Aussagen über die Existenz
    und Eindeutigkeit der Lösung(en) $\hat{x}$ zu treffen.
    Betrachte hierzu eine gewöhnliche Differentialgleichung $m-ter$ Ordnung (vgl. \eqref{eq:1}). Diese ist mit Hilfe
    der Funktionen $x_{j}:D \rightarrow \mathbb{R}$ für $j \in \{1,...,k\}$ äquivalent zu einem System erster Ordnung
    mit $m$ Gleichungen:
    \begin{empheq}[left={\empheqbiglbrace~}]{align*}
        x_{1}^{\prime}&=x_{2} \\
        x_{2}^{\prime}&=x_{3} \\
        &. \\
        &. \label{eq:3} \tag{\RNum{3}}\\
        &. \\
        x_{m-1}^{\prime}&=x_{m} \\
        x_{m}^{\prime}&=f(t, x_{1}, x_{2}, x_{3}, ..., x_{m}). \\
    \end{empheq}
    Für ein AWP \eqref{eq:2} gilt zusätzlich:
    \begin{empheq}[left={\empheqbiglbrace~}]{align*}
        x_{1}(t_{0})&=x_{0,1} \\
        x_{2}(t_{0})&=x_{0,2} \\
        &. \\
        &. \label{eq:4} \tag{\RNum{4}}\\
        &. \\
        x_{m-1}(t_{0})&=x_{0,m-1} \\
        x_{m}(t_{0})&=x_{0,m}. \\
    \end{empheq}

    \subsection{Existenz und Eindeutigkeit}
    In diesem Abschnitt betrachten wir ein Anfangswertproblem $erster$ Ordnung
    \begin{empheq}{align*}
        x^{\prime}&=f(t,x)\\
        x(t_{0})&=x_{0} \label{eq:5} \tag{\RNum{5}}
    \end{empheq}
    und zeigen, unter welchen Bedingungen der rechten Seite $f(t,x(t))$ eine Lösung existiert und ggf. eindeutig ist.

    \subsubsection{Existenz von Lösungen}
    Hier betrachten wir einen Satz, welcher zeigt, dass die Stetigkeit der rechten Seite $f$ für die Existenz einer
    Lösung ausreicht.
    \begin{satz}
        (Existenzsatz von Peano, quantitative und qualitative Version) \\
        Seien
        \[
            {\cal G}=\{(t,x) \in \mathbb{R} \times \mathbb{R}^{n}: |t-t_{0}| \leq \alpha, \quad
            \left\lVert x-x_{0} \right\rVert _{2} \leq\beta, \quad \alpha,\beta \geq 0 \}
        \]
        und $f:{\cal G} \rightarrow \mathbb{R}^{n}$ stetig. Dann besitzt das Anfangswertproblem \eqref{eq:5}
        mindestens eine Lösung $\hat{x}$ auf dem Intervall $D=\{t_{0}-a,t_{0}+a\}$, wobei
        \[
            a=\min\{\alpha, \frac{\beta}{M}\}, \qquad M= \max_{(t,y)\in {\cal G}}\{\left\lVert f(t,x)\right\rVert_{2} \}
            .
        \](Quantitative Version)\\
        Seien ${\cal G}\in \mathbb{R} \times \mathbb{R}^{n}$ offen und $f:{\cal G} \rightarrow \mathbb{R}^{n}$ stetig.
        Dann besitzt das Anfangswertproblem \eqref{eq:5} für jedes Paar $(t_{0},x_{0}) \in {\cal G}$ mindestens eine
        lokale Lösung, d.h., es existiert ein $a=a(t_{0},x_{0}) \geq 0$, sodass das Anfangswertproblem \eqref{eq:5} auf
        dem Intervall $[t_{0}-a,t_{0}+a]$ mindestens eine Lösung $\hat{x}$ hat. (Qualitative Version)
    \end{satz}
    $Beweis$ \cite[52-55]{beckGewohnlicheDifferentialgleichungen2018}

    \subsubsection{Eindeutigkeit von Lösungen}
    Ähnlich wie im vorherigen Kapitel existiert ein Satz, welcher zeigt, dass eine $lipschitz$-stetige
    \cite{LipschitzStetigkeitSerloMathe} rechte Seite $f$ reicht, damit eine eindeutige Lösung für eine
    gewöhnliche Differentialgleichung erster Ordnung existiert.
    \begin{satz}
        (Existenzsatz- und Eindeutigkeitssatz von Picard-Lindelöf, lokale quantitative und qualitative Version) \\
        Seien
        \[
            {\cal G}=\{(t,x) \in \mathbb{R} \times \mathbb{R}^{n}: |t-t_{0}| \leq \alpha, \quad
            \left\lVert x-x_{0} \right\rVert _{2} \leq\beta, \quad \alpha,\beta \geq 0 \},
        \]
        $(t_{o},x_{0})\in {\cal G}$ und $f:{\cal G} \rightarrow \mathbb{R}^{n}$ stetig und Lipschitz-stetig bzgl $x$.
        Dann besitzt das Anfangswertproblem \eqref{eq:5} genau eine Lösung $\hat{x}$ auf dem Intervall
        $D=\{t_{0}-a,t_{0}+a\}$, wobei
        \[
            a=\min\{\alpha, \frac{\beta}{M}\}, \qquad M= \max_{(t,y)\in {\cal G}}\{\left\lVert f(t,x)\right\rVert_{2} \}
            .
        \](Quantitative Version)\\
        Seien ${\cal G}\in \mathbb{R} \times \mathbb{R}^{n}$ offen und $f:{\cal G} \rightarrow \mathbb{R}^{n}$ stetig und lokal
        Lipschitz-stetig bzgl. $x$ auf $\cal{G}$. Dann besitzt das Anfangswertproblem \eqref{eq:5} für jedes Paar
        $(t_{0},x_{0}) \in {\cal G}$ genau eine lokale Lösung, d.h., es existiert ein $a=a(t_{0},x_{0}) \geq 0$, sodass
        das Anfangswertproblem \eqref{eq:5} auf dem Intervall $[t_{0}-a,t_{0}+a]$ genau eine Lösung $\hat{x}$ hat.
        (Qualitative Version)
    \end{satz}
    $Beweis$ \cite[56-58]{beckGewohnlicheDifferentialgleichungen2018}
    \cite{stykelSkriptZurVorlesung2020}

    \subsection{Abhängigkeit der Lösungen von den Daten}
    TODO: Motivation für den Abschnitt
    Um eine Aussage über die stetige Abhängigkeit der Anfangsdaten teffen zu können, beweisen wir zuerst einen wichtigen
    Hilfssatz.
    \begin{theorem} (Gronwallsche Ungleichung)
        Seien $D=[t_{0}, t_{f}]$ ein Intervall und die stetige, nichtnegative Funktion $u : D \rightarrow \mathbb{R}$
        sowie $a \geq 0, b > 0$ gegeben. Des Weiteren gilt folgende Ungleichung:
        \[
            u(t) \leq \alpha \int_{t_{0}}^{t}u(s)ds + \beta
        \]
        für alle $t \in D$. Dann gilt:
        \[
            u(t) \leq e^{\alpha(t-t_{0})}\beta
        \]
        für alle $t \in D$.
    \end{theorem}
    $Beweis.$ Definiere zuerst eine Hilfsfunktion
    \[
        v(t) := \alpha \int_{t_{0}}^{t} u(s)ds + \beta.
    \] Für diese gilt
    \[
        v^\prime(t) = \alpha u(t) \leq \alpha v(t)
    \] für alle $t \in D$. Daraus folgt
    \[
        (e^{-\alpha t}v(t))^\prime = e^{-\alpha t}(v(t)^\prime-\alpha v(t)) \leq 0, \qquad t \in D.
    \]
    Die Funktion $e^{-\alpha t} v(t)$ ist also monoton fallend, das bedeutet
    \[
        e^{-\alpha t} u(t) \leq e^{-\alpha t} v(t) \stackrel{t \geq t_{0}}{\leq} e^{-\alpha t_{0}} v(t_{0}) = e^{-\alpha t_{0}}\beta.
    \] Daraus folgt die Behauptung. \qedwhite \\
    Außerdem benötigen wir noch folgendes Lemma.
    \begin{lemma}
        Sei $T \subset \mathbb{R}^{1 + n}$ offen und $f:T \rightarrow \mathbb{R}$ eine stetige Funktion, die zusätzlich
        Lipschitz-stetig bezüglich der x-Variable ist mit
        \[
            \lvert f(t, x) - f(t,y) \rvert_{2} \leq L \lvert x - y \rvert_{2}
        \]
        für alle $(t,x),(t,y) \in T$ mit $L > 0$.
        Ist $\hat{x}$ eine stetig-differenzierbare Funktion auf dem Intervall $D \subset \mathbb{R}$ und eine Lösung des
        Anfangswertproblems \eqref{eq:5} und ist $\hat{x}_a$ eine stetig-differenzierbare Funktion und eine
        Näherungslösung mit $(t,\hat{x}_a(t))\in T$ für alle $t \in D$ und es gilt
        \begin{empheq}{align*}
            \left\lVert \hat{x}_a^{\prime}(t) - f(t,\hat{x}_a(t)) \right\rVert_{2} &\leq d_e \qquad t \in D,\\
            |t_{0} - \tilde{t_0}| &\leq d_t,\\
            \left\lVert x_0 - \hat{x}_a(\tilde{t_0}) \right\rVert_{2} &\leq d_a,\\
        \end{empheq}
        ($d_g$ representiert die Störung der rechten Seite, $d_t$ die Störung der Anfangszeit und $d_a$ die Störung
        des Anfangswerts).
        Dann gilt die Abschätzung
        \[
            \left\lVert \hat{x}(t) - \hat{x}_a(t) \right\rVert_{2} \leq
            e^{L|t-t_0|}(d_a + d_t(d_g + \sup_{s \in D} \left\lVert f(s, \hat{x}_a(s)) \right\rVert_2)
            + \frac{d_g}{L}) - \frac{d_g}{L}.
        \]
    \end{lemma}
    $Beweis.$ Betrachte zuerst die Differenz der Lösung $\hat{x}$ und $\hat{x}_a$ bei $t = t_0$.
    \begin{empheq}{align*}
        \left\lVert \hat{x}(t_0) - \hat{x}_a(t_0) \right\rVert_2 &= \left\lVert \hat{x}_0 -
        \int_{\tilde{t}_0}^{t_0} \hat{x}_a^\prime(s)ds - \hat{x}_a(\tilde{t}_{0}) \right\rVert_2 \\
        & \leq \left\lVert_2 \hat{x}_0 - \hat{x}_a(\tilde{t}_0)\right\rVert
        \left\lVert \int_{\tilde{t}_0}^{t_0} [\hat{x}_a^\prime(s) - f(s, \hat{x}_a(s))] ds \right\rVert_2
        \left\lVert \int_{\tilde{t}_0}^{t_0} f(s,\hat{x}_a(s)) ds \right\rVert_2 \\
        & \leq d_a + d_t(d_g + \sup_{s \in D} \left\lVert f(s,\hat{x}_a(s)) \right\rVert).
    \end{empheq}
    Nun können wir mit Hilfe der Lipschitz-Eigenschaft der rechten Seite $f$ die Differenz für allgemeines
    $t \in D , t > t_0$ abschätzen:
    \begin{empheq}{align*}
        \left\lVert \hat{x}(t) - \hat{x}_a(t) \right\rVert_2 &=
        \left\lVert \hat{x}_0 + \int_{t_0}^{t} f(s,\hat{x})ds - \hat{x}_a(t_0) - \int_{t_0}^{t} \hat{x}_a^{\prime}(s) ds \right\rVert_2\\
        &\leq \left\lVert \hat{x}_0 - \hat{x}_a(t_0) \right\rVert_2 +
        \int_{t_0}^{t} [\left\lVert f(s,\hat{x}(s)) - f(s,\hat{x}_a(s)) \right\rVert_2 +
        \left\lVert \hat{x}_a^{\prime}(s) - f(s,\hat{x}_a(s)) \right\rVert_2] ds \\
        &\leq d_a + d_t(d_g + \sup_{s\in D}\left\lVert f(s,\hat{x}_a(s)) \right\rVert_2) +
        \int_{t_0}^{t} [L \left\lVert \hat{x}(s) - \hat{x}_a(s) \right\rVert_2 + d_g] ds.
    \end{empheq}
    Um das gronwallsche Lemma verwenden zu können, setzen wir
    $u(t):=\left\lVert \hat{x}(t) - \hat{x}_a(t)\right\rVert_2 + \frac{d_g}{L}$,
    \[
        \beta:=d_a + d_t(d_g + \sup_{s\in D}\left\lVert f(s,\hat{x}_a(s)) \right\rVert_2 + \frac{d_g}{L})
    \] und $\alpha:=L$.
    Offensichtlich gilt
    \begin{empheq}{align*}
        &u(t) \leq \alpha \int_{t_0}^{t} u(s) ds + \beta\\
        \Leftrightarrow & \left\lVert \hat{x}(t) - \hat{x}_a(t)\right\rVert_2 + \frac{d_g}{L} \leq
        L \int_{t_0}^{t} \left[\left\lVert \hat{x}(s) - \hat{x}_a(s)\right\rVert_2 + \frac{d_g}{L}\right] ds + \beta \\
        \Leftrightarrow & \left\lVert \hat{x}(t) - \hat{x}_a(t)\right\rVert_2 \leq
        d_a + d_t(d_g + \sup_{s\in D}\left\lVert f(s,\hat{x}_a(s)) \right\rVert_2) +
        \int_{t_0}^{t} [L \left\lVert \hat{x}(s) - \hat{x}_a(s) \right\rVert_2 + d_g] ds - \frac{d_g}{L}
    \end{empheq}
    Also können wir das gronwallsche Lemma anwenden und somit folgt
    \[
        \left\lVert \hat{x}(t) - \hat{x}_a(t)\right\rVert_2 + \frac{d_g}{L} \leq
        e^{L(t-t_0)}\left[d_a + d_t(d_g + \sup_{s\in D}\left\lVert f(s,\hat{x}_a(s)) \right\rVert_2 + \frac{d_g}{L})\right].
    \]
    Der Beweis für $t \in D$ mit $t<t_0$ funktioniert analog. \qedwhite\\
    Nun können wir eine Abschätzung für eine Lösung eines Anfangswertproblems $u$ und eine Lösung mit gestörten
    Anfangswerten

    \section{Numerischer Lösungsansatz}
    \subsection{Methodenbeschreibung}
    \subsection{Fehlerdisskusion}
    \subsubsection{Konsistenz und Konvergenz}
    \subsubsection{Stabilität}

    \section{neuronale Netze}
    \subsection{Methodenbeschreibung}
    \subsection{Gewichtsinitialisierung}
    \subsection{Fehlerdisskussion (weighting function)}
    \subsection{curriculum learning}

    \section{Anwendungsbeispiele}

    \newpage
    \printbibliography[heading=bibintoc]
    \newpage
    \phantomsection
    \addcontentsline{toc}{section}{\listfigurename}
    \listoffigures
\end{document}